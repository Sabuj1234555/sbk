<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SBK AI Chatbot</title>
<style>
body {font-family: Arial; margin:0; background:#f0f0f0;}
.container {max-width:800px; margin:20px auto; background:white; border-radius:10px; padding:20px; box-shadow:0 0 10px rgba(0,0,0,0.1);}
#chatbox {height:400px; overflow-y:auto; border:1px solid #ccc; padding:10px; border-radius:5px; background:#fafafa;}
.message {margin:10px 0; padding:10px; border-radius:5px;}
.user {background:#d1e7dd; text-align:right;}
.bot {background:#f8d7da; text-align:left;}
input[type=text]{width:80%; padding:10px; border-radius:5px; border:1px solid #ccc;}
button {padding:10px 15px; border:none; border-radius:5px; background:#0d6efd; color:white; cursor:pointer;}
button:hover {background:#0b5ed7;}
.top-bar {display:flex; justify-content:space-between; margin-bottom:10px;}
</style>
</head>
<body>
<div class="container">
    <div class="top-bar">
        <button onclick="newChat()">New Chat</button>
        <button onclick="syncQA()">Sync DB</button>
    </div>
    <div id="chatbox"></div>
    <div style="margin-top:10px;">
        <input type="text" id="question" placeholder="আপনার প্রশ্ন লিখুন">
        <button onclick="sendQuestion()">Send</button>
    </div>
</div>

<script>
let chatbox = document.getElementById("chatbox");

function newChat(){
    chatbox.innerHTML = "";
}

async function syncQA(){
    let res = await fetch("/ai/sync/");
    let data = await res.json();
    alert(data.status);
}

async function sendQuestion(){
    let question = document.getElementById("question").value;
    if(!question) return;

    chatbox.innerHTML += `<div class="message user">${question}</div>`;
    document.getElementById("question").value = "";

    let res = await fetch("/ai/ask/", {
        method:"POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify({question})
    });
    let data = await res.json();
    chatbox.innerHTML += `<div class="message bot">${data.answer}</div>`;
    chatbox.scrollTop = chatbox.scrollHeight;
}
</script>
</body>
</html>